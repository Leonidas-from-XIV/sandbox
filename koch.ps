%!PS-Adobe-3.0
%%Title: (Koch snowflake)
%%Creator: (Marek Kubica <marek@xivilization.net>)
%%EndComments

% (order len) -- (order len)
/drawthird { %def
	% get a copy of order on top
	1 index
	% compare that to zero
	0 eq
	{ %ifelse: true
		% duplicate len
		dup
		% draw line
		0 rlineto
	}
	{ %ifelse: false
		% create copies of (order len)
		2 copy
		% create a mark and push it below these two values
		mark 3 1 roll

		% divide len/3, decrement order
		3 div
		exch
		1 sub
		exch

		% draw a segment, rotate afterwards
		drawthird
		60 rotate
		drawthird
		240 rotate
		drawthird
		60 rotate
		drawthird

		% delete everything to the mark
		cleartomark
	} ifelse

} def

% (order len) -- ()
/drawtriangle {
	% decrement order
	exch 1 sub exch

	60 rotate
	drawthird
	240 rotate
	drawthird
	240 rotate
	drawthird

	pop pop
} def

200 300 translate
0 0 moveto
3 300 drawtriangle
stroke
